---
import { Icon } from "astro-icon";
import ThemeToggle from "./ThemeToggle.astro";
---

<nav class="relative py-1 self-stretch flex items-center gap-3 sm:gap-4 group">
    <ul
        id="navMenu"
        class="transition sm:transition-none duration-75 ease-linear origin-top-right opacity-0 sm:opacity-100 scale-75 sm:scale-100 -z-50 sm:z-0 min-w-[12rem] sm:bg-transparent sm:dark:bg-transparent border-rpd-highlightLow dark:border-rp-highlightLow border-2 sm:border-0 rounded bg-rpd-surface dark:bg-rp-surface sm:gap-4 absolute sm:relative sm:top-0 right-0 top-full sm:flex"
    >
        <li>
            <a class="hover:underline block sm:inline p-2" href="/">Home</a>
        </li>
        <li>
            <a class="hover:underline block sm:inline p-2" href="/">Projects</a>
        </li>
        <li>
            <a class="hover:underline block sm:inline p-2" href="/">Contact</a>
        </li>
        <li>
            <a class="hover:underline block sm:inline p-2" href="/">Blog</a>
        </li>
    </ul>
    <ThemeToggle />
    <div
        id="navToggle"
        class="sm:hidden rounded p-2 bg-rpd-surface dark:bg-rp-surface cursor-pointer"
    >
        <Icon class="h-6 siu" name="menu_line" />
    </div>
</nav>

<script>
    const nav = document.getElementById("navMenu")!;
    const toggle = document.getElementById("navToggle")!;

    const handleNavToggle = () => {
        nav.classList.toggle("scale-75");
        nav.classList.toggle("opacity-0");
        nav.classList.toggle("-z-50");
    };

    let handleClickOutside = (event: Event) => {
        if (
            !nav.contains(event.target! as Node) &&
            !toggle.contains(event.target! as Node)
        ) {
            nav.classList.add("scale-75");
            nav.classList.add("opacity-0");
            nav.classList.add("-z-50");
        }
    };

    document
        .getElementById("navToggle")!
        .addEventListener("click", handleNavToggle);

    document.documentElement.addEventListener("click", handleClickOutside);
</script>
